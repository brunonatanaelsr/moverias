<!-- Modal Component Reutilizável -->
<div class="fixed inset-0 z-50 overflow-y-auto {{ modal_show|yesno:'block,hidden' }}" 
     id="{{ modal_id|default:'defaultModal' }}"
     x-data="{ open: {{ modal_show|yesno:'true,false' }} }"
     x-show="open"
     x-cloak>
    
    <!-- Backdrop -->
    <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"
         x-show="open"
         x-transition:enter="ease-out duration-300"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         x-transition:leave="ease-in duration-200"
         x-transition:leave-start="opacity-100"
         x-transition:leave-end="opacity-0"
         @click="open = false"></div>
    
    <!-- Modal Container -->
    <div class="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
        <!-- Trick para centralizar verticalmente -->
        <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
        
        <!-- Modal Content -->
        <div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle {{ modal_size|default:'sm:max-w-lg' }} sm:w-full"
             x-show="open"
             x-transition:enter="ease-out duration-300"
             x-transition:enter-start="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
             x-transition:enter-end="opacity-100 translate-y-0 sm:scale-100"
             x-transition:leave="ease-in duration-200"
             x-transition:leave-start="opacity-100 translate-y-0 sm:scale-100"
             x-transition:leave-end="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
             role="dialog" 
             aria-modal="true" 
             aria-labelledby="{{ modal_id|default:'defaultModal' }}-title">
            
            <!-- Header -->
            {% if modal_title %}
            <div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4 border-b border-gray-200">
                <div class="flex items-center justify-between">
                    <h3 class="text-lg leading-6 font-medium text-gray-900" id="{{ modal_id|default:'defaultModal' }}-title">
                        {{ modal_title }}
                    </h3>
                    <button type="button" 
                            class="bg-white rounded-md text-gray-400 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-move-purple-500"
                            @click="open = false">
                        <span class="sr-only">Fechar</span>
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                {% if modal_subtitle %}
                <p class="mt-2 text-sm text-gray-600">{{ modal_subtitle }}</p>
                {% endif %}
            </div>
            {% endif %}
            
            <!-- Body -->
            <div class="bg-white px-4 pt-5 pb-4 sm:p-6">
                {% if modal_icon %}
                <div class="mx-auto flex items-center justify-center h-12 w-12 rounded-full {{ modal_icon_bg|default:'bg-red-100' }} mb-4">
                    <i class="fas {{ modal_icon }} {{ modal_icon_color|default:'text-red-600' }} text-xl"></i>
                </div>
                {% endif %}
                
                <div class="{{ modal_body_class|default:'' }}">
                    {{ modal_content|safe }}
                </div>
            </div>
            
            <!-- Footer -->
            {% if modal_actions %}
            <div class="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                {{ modal_actions|safe }}
            </div>
            {% endif %}
        </div>
    </div>
</div>

<!-- JavaScript para controle programático -->
<script>
function openModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
        modal.__x.$data.open = true;
    }
}

function closeModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
        modal.__x.$data.open = false;
    }
}

// Fechar modal com ESC
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        // Fechar todos os modais abertos
        document.querySelectorAll('[x-data*="open"]').forEach(modal => {
            if (modal.__x && modal.__x.$data.open) {
                modal.__x.$data.open = false;
            }
        });
    }
});
</script>

<!-- Exemplo de uso:
{% include 'components/modal.html' with modal_id="confirmDelete" modal_title="Confirmar Exclusão" modal_subtitle="Esta ação não pode ser desfeita" modal_icon="fa-exclamation-triangle" modal_icon_bg="bg-red-100" modal_icon_color="text-red-600" modal_content="<p>Tem certeza que deseja excluir este item?</p>" modal_actions="<button onclick='closeModal(\"confirmDelete\")' class='mm-btn mm-btn-secondary mr-2'>Cancelar</button><button class='mm-btn mm-btn-danger'>Excluir</button>" %}
-->
