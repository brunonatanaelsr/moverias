<!-- Tabela de Dados Moderna -->
<div class="bg-white shadow overflow-hidden {{ table_container_class|default:'sm:rounded-md' }}">
    <!-- Header da Tabela -->
    {% if table_title or table_actions %}
    <div class="px-4 py-5 sm:px-6 border-b border-gray-200">
        <div class="flex items-center justify-between">
            {% if table_title %}
            <div>
                <h3 class="text-lg leading-6 font-medium text-gray-900">{{ table_title }}</h3>
                {% if table_subtitle %}
                <p class="mt-1 max-w-2xl text-sm text-gray-500">{{ table_subtitle }}</p>
                {% endif %}
            </div>
            {% endif %}
            
            {% if table_actions %}
            <div class="flex space-x-3">
                {{ table_actions|safe }}
            </div>
            {% endif %}
        </div>
        
        <!-- Filtros e Busca -->
        {% if show_search or table_filters %}
        <div class="mt-4 flex items-center justify-between">
            {% if show_search %}
            <div class="flex-1 max-w-lg">
                <div class="relative">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <i class="fas fa-search text-gray-400"></i>
                    </div>
                    <input type="text" 
                           class="block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-move-purple-500 focus:border-move-purple-500 sm:text-sm"
                           placeholder="{{ search_placeholder|default:'Buscar...' }}"
                           id="{{ table_id|default:'table' }}-search"
                           hx-get="{{ search_url }}"
                           hx-trigger="keyup changed delay:300ms"
                           hx-target="#{{ table_id|default:'table' }}-body">
                </div>
            </div>
            {% endif %}
            
            {% if table_filters %}
            <div class="flex space-x-2">
                {{ table_filters|safe }}
            </div>
            {% endif %}
        </div>
        {% endif %}
    </div>
    {% endif %}
    
    <!-- Tabela Responsiva -->
    <div class="overflow-x-auto">
        <table class="min-w-full divide-y divide-gray-200">
            <!-- Header -->
            {% if table_headers %}
            <thead class="bg-gray-50">
                <tr>
                    {% if show_selection %}
                    <th scope="col" class="relative px-6 py-3">
                        <input type="checkbox" 
                               class="absolute left-4 top-1/2 -mt-2 h-4 w-4 rounded border-gray-300 text-move-purple-600 focus:ring-move-purple-500"
                               id="select-all"
                               onchange="toggleAllRows(this)">
                    </th>
                    {% endif %}
                    
                    {% for header in table_headers %}
                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider {{ header.class|default:'' }}">
                        {% if header.sortable %}
                        <button class="group inline-flex items-center hover:text-gray-900"
                                hx-get="{{ sort_url }}?sort={{ header.sort_key }}"
                                hx-target="#{{ table_id|default:'table' }}-body">
                            {{ header.label }}
                            <span class="ml-2 flex-none rounded text-gray-400 group-hover:text-gray-500">
                                <i class="fas fa-sort text-xs"></i>
                            </span>
                        </button>
                        {% else %}
                        {{ header.label }}
                        {% endif %}
                    </th>
                    {% endfor %}
                    
                    {% if table_row_actions %}
                    <th scope="col" class="relative px-6 py-3">
                        <span class="sr-only">Ações</span>
                    </th>
                    {% endif %}
                </tr>
            </thead>
            {% endif %}
            
            <!-- Body -->
            <tbody id="{{ table_id|default:'table' }}-body" class="bg-white divide-y divide-gray-200">
                {% if table_rows %}
                    {% for row in table_rows %}
                    <tr class="{{ row.class|default:'hover:bg-gray-50' }}">
                        {% if show_selection %}
                        <td class="relative px-6 py-4">
                            <input type="checkbox" 
                                   class="absolute left-4 top-1/2 -mt-2 h-4 w-4 rounded border-gray-300 text-move-purple-600 focus:ring-move-purple-500 row-checkbox"
                                   value="{{ row.id }}"
                                   name="selected_ids">
                        </td>
                        {% endif %}
                        
                        {% for cell in row.cells %}
                        <td class="px-6 py-4 whitespace-nowrap {{ cell.class|default:'text-sm text-gray-900' }}">
                            {{ cell.content|safe }}
                        </td>
                        {% endfor %}
                        
                        {% if table_row_actions %}
                        <td class="relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6">
                            <div class="flex items-center justify-end space-x-2">
                                {% for action in row.actions|default:table_row_actions %}
                                <a href="{{ action.url }}" 
                                   class="{{ action.class|default:'text-move-purple-600 hover:text-move-purple-900' }}"
                                   {% if action.confirm %}onclick="return confirm('{{ action.confirm }}')"{% endif %}>
                                    {% if action.icon %}<i class="fas {{ action.icon }} mr-1"></i>{% endif %}
                                    {{ action.label }}
                                </a>
                                {% endfor %}
                            </div>
                        </td>
                        {% endif %}
                    </tr>
                    {% endfor %}
                {% else %}
                    <!-- Empty State -->
                    <tr>
                        <td colspan="{{ table_headers|length|add:2 }}" class="px-6 py-12 text-center">
                            <div class="flex flex-col items-center">
                                <i class="fas fa-inbox text-gray-400 text-4xl mb-4"></i>
                                <h3 class="text-lg font-medium text-gray-900 mb-2">{{ empty_title|default:'Nenhum dado encontrado' }}</h3>
                                <p class="text-gray-600">{{ empty_message|default:'Não há registros para exibir no momento.' }}</p>
                                {% if empty_action %}
                                <div class="section-spacing-sm">
                                    {{ empty_action|safe }}
                                </div>
                                {% endif %}
                            </div>
                        </td>
                    </tr>
                {% endif %}
            </tbody>
        </table>
    </div>
    
    <!-- Paginação -->
    {% if pagination %}
    <div class="bg-white px-4 py-3 border-t border-gray-200 sm:px-6">
        <div class="flex items-center justify-between">
            <div class="flex-1 flex justify-between sm:hidden">
                {% if pagination.has_previous %}
                <a href="?page={{ pagination.previous_page_number }}" 
                   class="relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
                    Anterior
                </a>
                {% endif %}
                {% if pagination.has_next %}
                <a href="?page={{ pagination.next_page_number }}" 
                   class="ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
                    Próximo
                </a>
                {% endif %}
            </div>
            
            <div class="hidden sm:flex-1 sm:flex sm:items-center sm:justify-between">
                <div>
                    <p class="text-sm text-gray-700">
                        Mostrando
                        <span class="font-medium">{{ pagination.start_index }}</span>
                        até
                        <span class="font-medium">{{ pagination.end_index }}</span>
                        de
                        <span class="font-medium">{{ pagination.paginator.count }}</span>
                        resultados
                    </p>
                </div>
                
                <nav class="relative z-0 inline-flex rounded-md shadow-sm -space-x-px">
                    <!-- Paginação detalhada aqui -->
                    {% include 'components/pagination.html' with page_obj=pagination %}
                </nav>
            </div>
        </div>
    </div>
    {% endif %}
</div>

<!-- JavaScript para funcionalidades da tabela -->
<script>
function toggleAllRows(checkbox) {
    const checkboxes = document.querySelectorAll('.row-checkbox');
    checkboxes.forEach(cb => cb.checked = checkbox.checked);
}

function getSelectedIds() {
    const checkboxes = document.querySelectorAll('.row-checkbox:checked');
    return Array.from(checkboxes).map(cb => cb.value);
}

function bulkAction(action, url) {
    const selectedIds = getSelectedIds();
    if (selectedIds.length === 0) {
        alert('Selecione pelo menos um item');
        return;
    }
    
    if (confirm(`Tem certeza que deseja ${action} ${selectedIds.length} item(s)?`)) {
        // Implementar ação em lote
        fetch(url, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
            },
            body: JSON.stringify({ ids: selectedIds })
        }).then(response => {
            if (response.ok) {
                location.reload();
            }
        });
    }
}
</script>

<!-- Exemplo de uso:
{% include 'components/table.html' with table_title="Lista de Usuários" table_headers=headers table_rows=rows show_search=True show_selection=True pagination=page_obj %}
-->
