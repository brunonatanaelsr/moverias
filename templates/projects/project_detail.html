{% extends 'dashboard_base.html' %}

{% block title %}{{ enrollment.project.name }} - {{ enrollment.beneficiary.full_name }} - Move Marias{% endblock %}

{% block content %}
<div class="mb-8">
    <div class="flex items-center justify-between">
        <div>
            <h1 class="text-3xl font-bold text-gray-900">{{ enrollment.project.name }}</h1>
            <p class="mt-2 text-sm text-gray-600">
                Matr√≠cula de {{ enrollment.beneficiary.full_name }}
            </p>
        </div>
        <div class="flex space-x-3">
            <a href="{% url 'projects:enrollment-update' enrollment.pk %}" 
               class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-purple-move hover:bg-purple-700">
                ‚úèÔ∏è Editar
            </a>
            <a href="{% url 'projects:enrollment-list' %}" 
               class="inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
                ‚Üê Voltar
            </a>
        </div>
    </div>
</div>

<div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
    <!-- Informa√ß√µes do Projeto -->
    <div class="lg:col-span-2">
        <div class="bg-white shadow rounded-lg p-6">
            <h3 class="text-lg font-medium text-gray-900 mb-4">üéØ Informa√ß√µes do Projeto</h3>
            
            <dl class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <dt class="text-sm font-medium text-gray-500">Nome do Projeto</dt>
                    <dd class="text-sm text-gray-900 font-medium">{{ enrollment.project.name }}</dd>
                </div>
                <div>
                    <dt class="text-sm font-medium text-gray-500">Status</dt>
                    <dd class="text-sm">
                        <span class="inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium
                            {% if enrollment.status == 'ATIVO' %}bg-green-100 text-green-800
                            {% elif enrollment.status == 'DESLIGADO' %}bg-red-100 text-red-800
                            {% else %}bg-gray-100 text-gray-800{% endif %}">
                            {{ enrollment.get_status_display }}
                        </span>
                    </dd>
                </div>
                <div>
                    <dt class="text-sm font-medium text-gray-500">C√≥digo de Matr√≠cula</dt>
                    <dd class="text-sm text-gray-900">{{ enrollment.enrollment_code|default:"N√£o definido" }}</dd>
                </div>
                <div>
                    <dt class="text-sm font-medium text-gray-500">Data de Cria√ß√£o</dt>
                    <dd class="text-sm text-gray-900">{{ enrollment.created_at|date:"d/m/Y" }}</dd>
                </div>
                {% if enrollment.project.description %}
                <div class="md:col-span-2">
                    <dt class="text-sm font-medium text-gray-500">Descri√ß√£o do Projeto</dt>
                    <dd class="text-sm text-gray-900">{{ enrollment.project.description }}</dd>
                </div>
                {% endif %}
            </dl>
        </div>

        <!-- Hor√°rios -->
        <div class="bg-white shadow rounded-lg p-6 mt-6">
            <h3 class="text-lg font-medium text-gray-900 mb-4">üìÖ Hor√°rios</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div>
                    <dt class="text-sm font-medium text-gray-500">Dia da Semana</dt>
                    <dd class="text-sm text-gray-900">{{ enrollment.get_weekday_display|default:"N√£o definido" }}</dd>
                </div>
                <div>
                    <dt class="text-sm font-medium text-gray-500">Hor√°rio de In√≠cio</dt>
                    <dd class="text-sm text-gray-900">{{ enrollment.start_time|time:"H:i"|default:"N√£o definido" }}</dd>
                </div>
                <div>
                    <dt class="text-sm font-medium text-gray-500">Turno</dt>
                    <dd class="text-sm text-gray-900">{{ enrollment.get_shift_display|default:"N√£o definido" }}</dd>
                </div>
            </div>
        </div>
    </div>

    <!-- Informa√ß√µes da Benefici√°ria -->
    <div>
        <div class="bg-white shadow rounded-lg p-6">
            <h3 class="text-lg font-medium text-gray-900 mb-4">üë§ Benefici√°ria</h3>
            
            <div class="text-center mb-4">
                <div class="w-16 h-16 bg-purple-move rounded-full flex items-center justify-center mx-auto mb-3">
                    <span class="text-white text-2xl font-bold">{{ enrollment.beneficiary.full_name|first }}</span>
                </div>
                <h4 class="text-lg font-medium text-gray-900">{{ enrollment.beneficiary.full_name }}</h4>
                <p class="text-sm text-gray-500">{{ enrollment.beneficiary.neighbourhood }}</p>
            </div>
            
            <dl class="space-y-2">
                <div>
                    <dt class="text-xs font-medium text-gray-500">Data de Nascimento</dt>
                    <dd class="text-sm text-gray-900">{{ enrollment.beneficiary.dob|date:"d/m/Y" }} ({{ enrollment.beneficiary.age }} anos)</dd>
                </div>
                <div>
                    <dt class="text-xs font-medium text-gray-500">Telefone</dt>
                    <dd class="text-sm text-gray-900">{{ enrollment.beneficiary.phone_1 }}</dd>
                </div>
                <div>
                    <dt class="text-xs font-medium text-gray-500">Cadastrada em</dt>
                    <dd class="text-sm text-gray-900">{{ enrollment.beneficiary.created_at|date:"d/m/Y" }}</dd>
                </div>
            </dl>
            
            <div class="mt-4 pt-4 border-t border-gray-200">
                <a href="{% url 'dashboard:beneficiary_detail' enrollment.beneficiary.pk %}" 
                   class="w-full inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-purple-move hover:bg-purple-700">
                    Ver Perfil Completo
                </a>
            </div>
        </div>

        <!-- A√ß√µes R√°pidas -->
        <div class="bg-white shadow rounded-lg p-6 mt-6">
            <h3 class="text-lg font-medium text-gray-900 mb-4">‚ö° A√ß√µes R√°pidas</h3>
            
            <div class="space-y-3">
                <a href="{% url 'evolution:create' %}?beneficiary={{ enrollment.beneficiary.pk }}" 
                   class="w-full inline-flex items-center justify-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
                    üìà Novo Registro de Evolu√ß√£o
                </a>
                
                <a href="{% url 'social:anamnesis_create' %}?beneficiary={{ enrollment.beneficiary.pk }}" 
                   class="w-full inline-flex items-center justify-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
                    üìã Nova Anamnese Social
                </a>
                
                <button type="button" 
                        onclick="generateCertificate()"
                        class="w-full inline-flex items-center justify-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
                    üìÑ Gerar Certificado
                </button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
function generateCertificate() {
    alert('Funcionalidade de gera√ß√£o de certificado ser√° implementada em breve!');
}
</script>
{% endblock %}
