{% extends 'dashboard_base.html' %}

{% block title %}{{ beneficiary.full_name }} - Move Marias{% endblock %}

{% block extra_css %}
<style>
    .tab-content { display: none; }
    .tab-content.active { display: block; }
    .tab-button.active { 
        @apply bg-purple-move text-white; 
        border-bottom-color: #8B5CF6;
    }
</style>
{% endblock %}

{% block content %}
<div class="mb-6">
    <div class="flex items-center justify-between">
        <div>
            <h1 class="text-3xl font-bold text-gray-900">{{ beneficiary.full_name }}</h1>
            <p class="mt-1 text-sm text-gray-500">
                Cadastrada em {{ beneficiary.created_at|date:"d/m/Y" }}
            </p>
        </div>
        <div class="flex space-x-3">
            <a href="{% url 'dashboard:beneficiary_edit' beneficiary.pk %}" 
               class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-purple-move hover:bg-purple-700">
                ✏️ Editar
            </a>
            <a href="{% url 'dashboard:beneficiaries_list' %}" 
               class="inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
                ← Voltar
            </a>
        </div>
    </div>
</div>

<!-- Tabs Navigation -->
<div class="mb-6">
    <nav class="flex space-x-8 border-b border-gray-200">
        <button onclick="showTab('personal')" 
                class="tab-button active py-2 px-1 border-b-2 font-medium text-sm text-purple-move border-purple-move">
            👤 Dados Pessoais
        </button>
        <button onclick="showTab('social')" 
                class="tab-button py-2 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300">
            📋 Anamnese Social
        </button>
        <button onclick="showTab('projects')" 
                class="tab-button py-2 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300">
            📚 Projetos
        </button>
        <button onclick="showTab('evolution')" 
                class="tab-button py-2 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300">
            📈 Evolução
        </button>
        <button onclick="showTab('coaching')" 
                class="tab-button py-2 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300">
            🎯 Coaching
        </button>
    </nav>
</div>

<!-- Tab Contents -->
<div id="personal" class="tab-content active">
    <div class="bg-white shadow rounded-lg p-6">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Dados Pessoais -->
            <div>
                <h3 class="text-lg font-medium text-gray-900 mb-4">👤 Dados Pessoais</h3>
                <dl class="space-y-3">
                    <div>
                        <dt class="text-sm font-medium text-gray-500">Nome Completo</dt>
                        <dd class="text-sm text-gray-900">{{ beneficiary.full_name }}</dd>
                    </div>
                    <div>
                        <dt class="text-sm font-medium text-gray-500">Data de Nascimento</dt>
                        <dd class="text-sm text-gray-900">
                            {{ beneficiary.dob|date:"d/m/Y" }}
                            <span class="text-gray-500">({{ beneficiary.age }} anos)</span>
                        </dd>
                    </div>
                    {% if beneficiary.nis %}
                    <div>
                        <dt class="text-sm font-medium text-gray-500">NIS</dt>
                        <dd class="text-sm text-gray-900">{{ beneficiary.nis }}</dd>
                    </div>
                    {% endif %}
                </dl>
            </div>

            <!-- Contato -->
            <div>
                <h3 class="text-lg font-medium text-gray-900 mb-4">📞 Contato</h3>
                <dl class="space-y-3">
                    <div>
                        <dt class="text-sm font-medium text-gray-500">Telefone Principal</dt>
                        <dd class="text-sm text-gray-900">{{ beneficiary.phone_1 }}</dd>
                    </div>
                    {% if beneficiary.phone_2 %}
                    <div>
                        <dt class="text-sm font-medium text-gray-500">Telefone Secundário</dt>
                        <dd class="text-sm text-gray-900">{{ beneficiary.phone_2 }}</dd>
                    </div>
                    {% endif %}
                    {% if beneficiary.email %}
                    <div>
                        <dt class="text-sm font-medium text-gray-500">E-mail</dt>
                        <dd class="text-sm text-gray-900">{{ beneficiary.email }}</dd>
                    </div>
                    {% endif %}
                </dl>
            </div>

            <!-- Endereço -->
            <div>
                <h3 class="text-lg font-medium text-gray-900 mb-4">🏠 Endereço</h3>
                <dl class="space-y-3">
                    <div>
                        <dt class="text-sm font-medium text-gray-500">Bairro</dt>
                        <dd class="text-sm text-gray-900">{{ beneficiary.neighbourhood }}</dd>
                    </div>
                    <div>
                        <dt class="text-sm font-medium text-gray-500">Endereço</dt>
                        <dd class="text-sm text-gray-900">{{ beneficiary.address }}</dd>
                    </div>
                    {% if beneficiary.reference %}
                    <div>
                        <dt class="text-sm font-medium text-gray-500">Referência</dt>
                        <dd class="text-sm text-gray-900">{{ beneficiary.reference }}</dd>
                    </div>
                    {% endif %}
                </dl>
            </div>
        </div>

        {% if beneficiary.observations %}
        <div class="mt-6 pt-6 border-t border-gray-200">
            <h3 class="text-lg font-medium text-gray-900 mb-3">📝 Observações</h3>
            <p class="text-sm text-gray-700 whitespace-pre-wrap">{{ beneficiary.observations }}</p>
        </div>
        {% endif %}
    </div>
</div>

<div id="social" class="tab-content">
    <div class="bg-white shadow rounded-lg p-6">
        <div class="text-center py-12">
            <div class="text-gray-400 text-6xl mb-4">📋</div>
            <h3 class="text-lg font-medium text-gray-900 mb-2">Anamnese Social</h3>
            <p class="text-gray-500 mb-6">Ainda não foi realizada a anamnese social desta beneficiária.</p>
            <a href="{% url 'social:anamnesis_create' %}?beneficiary={{ beneficiary.pk }}" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-purple-move hover:bg-purple-700">
                📋 Iniciar Anamnese
            </a>
        </div>
    </div>
</div>

<div id="projects" class="tab-content">
    <div class="bg-white shadow rounded-lg p-6">
        <div class="text-center py-12">
            <div class="text-gray-400 text-6xl mb-4">📚</div>
            <h3 class="text-lg font-medium text-gray-900 mb-2">Projetos</h3>
            <p class="text-gray-500 mb-6">Esta beneficiária ainda não está inscrita em nenhum projeto.</p>
            <a href="{% url 'projects:enrollment-create' %}?beneficiary={{ beneficiary.pk }}" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-purple-move hover:bg-purple-700">
                📚 Inscrever em Projeto
            </a>
        </div>
    </div>
</div>

<div id="evolution" class="tab-content">
    <div class="bg-white shadow rounded-lg p-6">
        <div class="text-center py-12">
            <div class="text-gray-400 text-6xl mb-4">📈</div>
            <h3 class="text-lg font-medium text-gray-900 mb-2">Evolução</h3>
            <p class="text-gray-500 mb-6">Nenhum registro de evolução encontrado.</p>
            <a href="{% url 'evolution:create' %}?beneficiary={{ beneficiary.pk }}" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-purple-move hover:bg-purple-700">
                📝 Novo Registro
            </a>
        </div>
    </div>
</div>

<div id="coaching" class="tab-content">
    <div class="bg-white shadow rounded-lg p-6">
        <div class="text-center py-12">
            <div class="text-gray-400 text-6xl mb-4">🎯</div>
            <h3 class="text-lg font-medium text-gray-900 mb-2">Coaching</h3>
            <p class="text-gray-500 mb-6">Nenhum plano de ação ou roda da vida registrados.</p>
            <div class="flex justify-center space-x-4">
                <a href="{% url 'coaching:action_plan_create' %}?beneficiary={{ beneficiary.pk }}" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-purple-move hover:bg-purple-700">
                    🎯 Novo Plano de Ação
                </a>
                <a href="{% url 'coaching:wheel_create' %}?beneficiary={{ beneficiary.pk }}" class="inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
                    🔄 Roda da Vida
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
function showTab(tabName) {
    // Hide all tab contents
    document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.remove('active');
    });
    
    // Remove active class from all tab buttons
    document.querySelectorAll('.tab-button').forEach(button => {
        button.classList.remove('active', 'text-purple-move', 'border-purple-move');
        button.classList.add('text-gray-500', 'border-transparent');
    });
    
    // Show selected tab content
    document.getElementById(tabName).classList.add('active');
    
    // Activate selected tab button
    event.target.classList.remove('text-gray-500', 'border-transparent');
    event.target.classList.add('active', 'text-purple-move', 'border-purple-move');
}
</script>
{% endblock %}
