{% extends 'dashboard_base.html' %}
{% block title %}Relatório da Beneficiária - {{ beneficiary.full_name }}{% endblock %}
{% block content %}
<div class="max-w-5xl mx-auto">
    <div class="mb-8 flex items-center justify-between">
        <h1 class="text-3xl font-bold text-gray-900">Relatório da Beneficiária</h1>
        <a href="{% url 'members:beneficiary-list' %}" class="text-gray-600 hover:text-gray-900 flex items-center">
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
            </svg>
            Voltar à Lista
        </a>
    </div>
    <div class="bg-white shadow rounded-lg p-6 mb-8">
        <h2 class="text-xl font-semibold mb-4">Dados Gerais</h2>
        <dl class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div><dt class="font-medium">Nome:</dt><dd>{{ beneficiary.full_name }}</dd></div>
            <div><dt class="font-medium">Idade:</dt><dd>{{ age }} anos</dd></div>
            <div><dt class="font-medium">Status:</dt><dd>{{ beneficiary.get_status_display }}</dd></div>
            <div><dt class="font-medium">Endereço:</dt><dd>{{ address }}</dd></div>
            <div><dt class="font-medium">Bairro:</dt><dd>{{ neighbourhood }}</dd></div>
            <div><dt class="font-medium">Nº de Filhos:</dt><dd>{{ number_of_children|default:'Não informado' }}</dd></div>
            <div><dt class="font-medium">Cadastro Completo?</dt><dd>{% if is_complete %}<span class="text-green-600 font-bold">Sim</span>{% else %}<span class="text-red-600 font-bold">Não</span>{% endif %}</dd></div>
            <div><dt class="font-medium">Vulnerabilidade:</dt><dd>{% if is_vulnerable %}<span class="text-red-600 font-bold">Sim</span>{% else %}<span class="text-green-600 font-bold">Não</span>{% endif %}</dd></div>
        </dl>
        {% if not is_complete %}
        <div class="mt-4 text-sm text-red-600">
            <strong>Campos faltando:</strong> {{ missing_fields|join:', ' }}
        </div>
        {% endif %}
    </div>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        <div class="bg-white shadow rounded-lg p-6">
            <h3 class="text-lg font-semibold mb-4">Oficinas</h3>
            {% if workshop_enrollments %}
                <ul class="space-y-2">
                {% for enrollment in workshop_enrollments %}
                    <li>
                        <span class="font-medium">{{ enrollment.workshop.name }}</span> - {{ enrollment.get_status_display }}<br>
                        <span class="text-xs text-gray-500">Inscrita em: {{ enrollment.enrollment_date|date:"d/m/Y" }}</span>
                    </li>
                {% endfor %}
                </ul>
            {% else %}
                <p class="text-gray-500">Nenhuma oficina encontrada.</p>
            {% endif %}
        </div>
        <div class="bg-white shadow rounded-lg p-6">
            <h3 class="text-lg font-semibold mb-4">Projetos</h3>
            {% if project_enrollments %}
                <ul class="space-y-2">
                {% for enrollment in project_enrollments %}
                    <li>
                        <span class="font-medium">{{ enrollment.project.name }}</span> - {{ enrollment.get_status_display }}<br>
                        <span class="text-xs text-gray-500">Matrícula: {{ enrollment.created_at|date:"d/m/Y" }}</span>
                    </li>
                {% endfor %}
                </ul>
            {% else %}
                <p class="text-gray-500">Nenhum projeto encontrado.</p>
            {% endif %}
        </div>
    </div>
    <div class="bg-white shadow rounded-lg p-6 mt-8">
        <h3 class="text-lg font-semibold mb-4">Anamneses Sociais</h3>
        {% if social_anamneses %}
            <ul class="space-y-2">
            {% for anamnese in social_anamneses %}
                <li>
                    <span class="font-medium">{{ anamnese.created_at|date:"d/m/Y" }}</span> - Vulnerabilidade: {% if anamnese.vulnerability %}<span class="text-red-600 font-bold">Sim</span>{% else %}<span class="text-green-600 font-bold">Não</span>{% endif %}
                </li>
            {% endfor %}
            </ul>
        {% else %}
            <p class="text-gray-500">Nenhuma anamnese registrada.</p>
        {% endif %}
    </div>
    <div class="bg-white shadow rounded-lg p-6 mt-8">
        <h3 class="text-lg font-semibold mb-4">Insights</h3>
        <ul class="list-disc pl-6 space-y-1">
            <li>Total de oficinas: {{ insights.total_workshops }}</li>
            <li>Total de projetos: {{ insights.total_projects }}</li>
            <li>Total de anamneses: {{ insights.total_anamneses }}</li>
            <li>Status atual: {% if insights.is_active %}Ativa{% else %}Inativa{% endif %}</li>
            <!-- Adicione mais insights conforme necessário -->
        </ul>
    </div>
</div>
{% endblock %}
