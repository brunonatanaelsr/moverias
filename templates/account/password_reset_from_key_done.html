{% extends "layouts/public_base.html" %}
{% load static %}

{% block title %}Senha Alterada - Move Marias{% endblock %}

{% block content %}
<div class="min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8">
    <div class="max-w-md w-full space-y-8">
        <div>
            <!-- Logo -->
            <div class="flex justify-center">
                <img class="h-16 w-auto" src="{% static 'images/logo-move-marias.png' %}" alt="Move Marias" 
                     onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                <div class="hidden h-16 w-16 bg-pink-600 rounded-full flex items-center justify-center">
                    <span class="text-white font-bold text-xl">MM</span>
                </div>
            </div>

            <!-- Ícone de sucesso -->
            <div class="flex justify-center mt-6">
                <div class="mx-auto flex items-center justify-center h-20 w-20 rounded-full bg-green-100 animate-pulse">
                    <svg class="h-10 w-10 text-green-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                </div>
            </div>

            <h2 class="mt-6 text-center text-3xl font-bold tracking-tight text-gray-900">
                Senha Alterada com Sucesso!
            </h2>
            <p class="mt-2 text-center text-sm text-gray-600">
                Sua senha foi atualizada. Agora você pode fazer login com sua nova senha.
            </p>
        </div>
        
        <!-- Informações de segurança -->
        <div class="bg-green-50 border border-green-200 rounded-md p-6">
            <div class="flex">
                <div class="flex-shrink-0">
                    <svg class="h-5 w-5 text-green-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
                    </svg>
                </div>
                <div class="ml-3">
                    <h3 class="text-sm font-medium text-green-800">
                        Sua conta está segura
                    </h3>
                    <div class="mt-1 text-sm text-green-700">
                        <p>Sua senha foi alterada em {{ now|date:"d/m/Y H:i" }}. Todas as sessões ativas foram encerradas por segurança.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Lembretes de segurança -->
        <div class="bg-blue-50 border border-blue-200 rounded-md p-4">
            <div class="flex items-start">
                <div class="flex-shrink-0">
                    <svg class="h-5 w-5 text-blue-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                </div>
                <div class="ml-3">
                    <h3 class="text-sm font-medium text-blue-800">
                        Lembre-se
                    </h3>
                    <div class="mt-1 text-sm text-blue-700">
                        <ul class="list-disc list-inside space-y-1">
                            <li>Use sua nova senha para fazer login</li>
                            <li>Mantenha sua senha segura e privada</li>
                            <li>Considere ativar a autenticação de dois fatores</li>
                            <li>Entre em contato conosco se notar atividade suspeita</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Botão para fazer login -->
        <div>
            <a href="{% url 'account_login' %}" class="group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-pink-600 hover:bg-pink-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-pink-500 transition duration-150 ease-in-out">
                <span class="absolute left-0 inset-y-0 flex items-center pl-3">
                    <svg class="h-5 w-5 text-pink-500 group-hover:text-pink-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1" />
                    </svg>
                </span>
                Fazer Login Agora
            </a>
        </div>

        <!-- Link para página inicial -->
        <div class="text-center">
            <a href="/" class="text-sm text-gray-600 hover:text-gray-500">
                Voltar para a página inicial
            </a>
        </div>

        <!-- Contato para suporte -->
        <div class="text-center">
            <p class="text-sm text-gray-600">
                Problemas com o login? 
                <a href="mailto:suporte@movemarias.org" class="text-pink-600 hover:text-pink-500">
                    Entre em contato conosco
                </a>
            </p>
        </div>

        <!-- Rodapé -->
        <div class="text-center text-xs text-gray-500">
            <p>&copy; {{ current_year|default:"2025" }} Move Marias. Todos os direitos reservados.</p>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Animação de entrada
    const container = document.querySelector('.max-w-md');
    container.style.opacity = '0';
    container.style.transform = 'translateY(20px)';
    
    setTimeout(() => {
        container.style.transition = 'all 0.6s ease-out';
        container.style.opacity = '1';
        container.style.transform = 'translateY(0)';
    }, 100);
    
    // Confete de celebração
    function createConfetti() {
        const colors = ['#EC4899', '#8B5CF6', '#10B981', '#F59E0B', '#EF4444'];
        const confettiCount = 50;
        
        for (let i = 0; i < confettiCount; i++) {
            const confetti = document.createElement('div');
            confetti.style.position = 'fixed';
            confetti.style.left = Math.random() * 100 + 'vw';
            confetti.style.top = '-10px';
            confetti.style.width = '8px';
            confetti.style.height = '8px';
            confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
            confetti.style.pointerEvents = 'none';
            confetti.style.zIndex = '9999';
            confetti.style.borderRadius = '50%';
            
            document.body.appendChild(confetti);
            
            const fallDuration = Math.random() * 3 + 2;
            const rotation = Math.random() * 360;
            
            confetti.animate([
                {
                    transform: `translateY(0px) rotate(0deg)`,
                    opacity: 1
                },
                {
                    transform: `translateY(${window.innerHeight + 10}px) rotate(${rotation}deg)`,
                    opacity: 0
                }
            ], {
                duration: fallDuration * 1000,
                easing: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)'
            });
            
            setTimeout(() => {
                confetti.remove();
            }, fallDuration * 1000);
        }
    }
    
    // Executar confete após um pequeno delay
    setTimeout(createConfetti, 500);
    
    // Auto-redirect para login após 10 segundos (opcional)
    let countdown = 10;
    const loginButton = document.querySelector('a[href*="account_login"]');
    const originalText = loginButton.textContent;
    
    function updateCountdown() {
        if (countdown > 0) {
            loginButton.innerHTML = `
                <span class="absolute left-0 inset-y-0 flex items-center pl-3">
                    <svg class="h-5 w-5 text-pink-500 group-hover:text-pink-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1" />
                    </svg>
                </span>
                Fazer Login Agora (${countdown}s)
            `;
            countdown--;
            setTimeout(updateCountdown, 1000);
        } else {
            // Redirecionar automaticamente
            window.location.href = loginButton.href;
        }
    }
    
    // Iniciar countdown após 3 segundos
    setTimeout(() => {
        updateCountdown();
    }, 3000);
    
    // Parar countdown se o usuário interagir com a página
    document.addEventListener('click', () => {
        countdown = 0;
        loginButton.innerHTML = `
            <span class="absolute left-0 inset-y-0 flex items-center pl-3">
                <svg class="h-5 w-5 text-pink-500 group-hover:text-pink-400" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013 3v1" />
                </svg>
            </span>
            ${originalText}
        `;
    }, { once: true });
});
</script>

<style>
@keyframes pulse {
    0%, 100% {
        opacity: 1;
        transform: scale(1);
    }
    50% {
        opacity: 0.8;
        transform: scale(1.05);
    }
}

.animate-pulse {
    animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}
</style>
{% endblock %}
